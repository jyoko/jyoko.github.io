<!doctype html><html class="theme-next use-motion"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css"><link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css"><meta name="keywords" content="Hexo, NexT"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2"><meta name="description" content="Nobody can deny it, Functional Programming - capital FP, as in the paradigm - is hot right now. Even Java, the prime example of Object-Oriented Programming, has added lambdas (or as you might know the"><meta property="og:type" content="article"><meta property="og:title" content="Reduce All the Things!"><meta property="og:url" content="http://jyoko.github.io/2015/11/7/reduce-all-the-things/index.html"><meta property="og:site_name" content="jrandm thoughts"><meta property="og:description" content="Nobody can deny it, Functional Programming - capital FP, as in the paradigm - is hot right now. Even Java, the prime example of Object-Oriented Programming, has added lambdas (or as you might know the"><meta property="og:updated_time" content="2016-02-17T04:09:24.781Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Reduce All the Things!"><meta name="twitter:description" content="Nobody can deny it, Functional Programming - capital FP, as in the paradigm - is hot right now. Even Java, the prime example of Object-Oriented Programming, has added lambdas (or as you might know the"><script type="text/javascript" id="hexo.configuration">var CONFIG={scheme:"Mist",sidebar:"remove",motion:!0};</script><title>Reduce All the Things! | jrandm thoughts</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><!--[if lte IE 8]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div><![endif]--><div class="container one-column page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">jrandm thoughts</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Whatever crosses my mind</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-home fa-fw"></i><br>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-th fa-fw"></i><br>Categories</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-user fa-fw"></i><br>About</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-archive fa-fw"></i><br>Archives</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline">Reduce All the Things!</h1><div class="post-meta"><span class="post-time">Posted on <time itemprop="dateCreated" datetime="2015-11-07T03:00:00-05:00" content="2015-11-07">2015-11-07</time></span> <span class="post-category">&nbsp; | &nbsp; In <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/learn2code/" itemprop="url" rel="index"><span itemprop="name">Learn2Code</span></a></span></span></div></header><div class="post-body"><span itemprop="articleBody"><p>Nobody can deny it, Functional Programming - capital FP, as in the paradigm - is hot right now. Even Java, the prime example of Object-Oriented Programming, has added lambdas (or as you might know them, JS folks, anonymous functions). This recent explosion in popularity has led to more interest in writing code in a declarative, functional style, and means knowing how to structure algorithms and applications in this new style.</p><p>At another time I'll talk about this style of programming in general, but today I want to talk about the one helper function that seems to give lots of beginners fits: <code>reduce</code> Conceptually, a reduce or <em>fold</em> is pretty easy to understand. You take a list of some values, and starting from one side, combine the values until you're have one value representing the combined list.</p><p>Since I'm sure many of you have read that and it didn't help at all, let's try walking through this process in a familiar way.</p><p>Let's take a list of numbers:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span></span><br></pre></td></tr></table></figure><p>And say we want to add them together. How would you write that out? Probably something like:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>  + <span class="number">2</span> = <span class="number">3</span></span><br><span class="line"><span class="number">3</span>  + <span class="number">3</span> = <span class="number">6</span></span><br><span class="line"><span class="number">6</span>  + <span class="number">4</span> = <span class="number">10</span></span><br><span class="line"><span class="number">10</span> + <span class="number">5</span> = <span class="number">15</span></span><br></pre></td></tr></table></figure><p>Do you notice any pattern here? The solution (right of the equals sign) to each line is the new first value for the next operation. Let's examine how you might write a simple program that computers this same answer:</p><figure class="highlight js"><figcaption><span>Add an Array</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addList</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.length; i++) &#123;</span><br><span class="line">    sum += arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(addList(arr)); <span class="comment">// 15</span></span><br></pre></td></tr></table></figure><p>Pretty straightforward, right? But break down some of assumptions we've made.</p><ol><li>Since we need an ordered list, we have to accept an array</li><li>Our sum can always start at 0</li></ol><p>Doesn't seem like much, but both are significant. The first is that since our order does matter, this operation only makes sense on an array (objects in Javascript not having any implied order). We can prove this but changing the addition to subtraction.</p><figure class="highlight js"><figcaption><span>Subtract an Array</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> rev = arr.slice().reverse();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">subtractList</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.length; i++) &#123;</span><br><span class="line">    ans -= arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(subtractList(arr)); <span class="comment">// -15</span></span><br><span class="line"><span class="built_in">console</span>.log(subtractList(rev)); <span class="comment">// -15</span></span><br></pre></td></tr></table></figure><p>Well... wait. Is that right? If we write these out by hand again:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>  - <span class="number">2</span> = -<span class="number">1</span></span><br><span class="line">-<span class="number">1</span> - <span class="number">3</span> = -<span class="number">4</span></span><br><span class="line">-<span class="number">4</span> - <span class="number">4</span> = -<span class="number">8</span></span><br><span class="line">-<span class="number">8</span> - <span class="number">5</span> = -<span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>  - <span class="number">4</span> = <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  - <span class="number">3</span> = -<span class="number">2</span></span><br><span class="line">-<span class="number">2</span> - <span class="number">2</span> = -<span class="number">4</span></span><br><span class="line">-<span class="number">4</span> - <span class="number">1</span> = -<span class="number">5</span></span><br></pre></td></tr></table></figure><p>Those aren't -15. What's going wrong? Our second assumption up above, that we're safe starting from zero, doesn't apply. In fact, we don't want to assume <em>any</em> starting value, right? When we work by hand, we use the first item in our list. We can do that via code pretty easily.</p><figure class="highlight js"><figcaption><span>Fixed Subtract an Array</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> rev = arr.slice().reverse();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">subtractList</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ans = arr[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;arr.length; i++) &#123;</span><br><span class="line">    ans -= arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(subtractList(arr)); <span class="comment">// -13</span></span><br><span class="line"><span class="built_in">console</span>.log(subtractList(rev)); <span class="comment">// -5</span></span><br></pre></td></tr></table></figure><p>Awesome, right answers. Now, as you're probably used to doing if you've been implementing these higher-order helper functions, we want to remove the operation from the function we're writing, and instead take a <strong>callback</strong> that defines how to combine the two values. Let's examine how &amp; why this works, first by modifying the adding function a bit:</p><figure class="highlight js"><figcaption><span>Add an Array v2</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addList</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sum = arr[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;arr.length; i++) &#123;</span><br><span class="line">    sum = sum + arr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(addList(arr)); <span class="comment">// 15</span></span><br></pre></td></tr></table></figure><p>Did you spot the little change? It's on line 5 above. Instead of using the shorthand <code>+=</code>, I switched it around to the long form. Now it mimics how it looks when we wrote the steps out by hand.</p><p>At this point I want you to stop and consider that <code>+</code> itself is a function. Sure, it doesn't look like what you traditionally think of as a function. But if you think of it as taking arguments from the left and right side of itself (that's called an <em>infix</em> operator), you can easily imagine it rewritten to look like <code>+(sum, arr[i])</code>. Expanding from that, what if we write our own <code>add</code> function and use that in lieu of the built-in <code>+</code>:</p><figure class="highlight js"><figcaption><span>Add an Array v3</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addList</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sum = arr[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;arr.length; i++) &#123;</span><br><span class="line">    sum = add(sum, arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(addList(arr)); <span class="comment">// 15</span></span><br></pre></td></tr></table></figure><p>Nothing has changed in how we compute our answer, but we've restructured the logic. Hopefully you're seeing where I'm going with this: What would it look like if we write a function that takes both a list and an operation? Could we change that last code a bit and have it work for all the tests we've used so far?</p><figure class="highlight js"><figcaption><span>Wait... This is Reduce!</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> rev = arr.slice().reverse();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">subtract</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a-b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">combineList</span>(<span class="params">arr, operation</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ans = arr[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;arr.length; i++) &#123;</span><br><span class="line">    ans = operation(ans, arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(combineList(arr, add)); <span class="comment">// 15</span></span><br><span class="line"><span class="built_in">console</span>.log(combineList(arr, subtract)); <span class="comment">// -13</span></span><br><span class="line"><span class="built_in">console</span>.log(combineList(rev, subtract)); <span class="comment">// -5</span></span><br></pre></td></tr></table></figure><p>Coming together nicely now - believe it or not, this is a working, simple reduce! Try to add an optional starting value (eg: I want to start adding my list at 1000) and see how else you could write the looping logic (think recursion and other functional helpers you might see in Lodash). Check out <a href="/2015/11/8/reduce-all-the-things-part2/">Reduce All The Things part 2</a> for solutions and discussion if you get stuck!</p></span></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2015/10/30/terminal-wizard-part3/" rel="next" title="Terminal Wizard part 3"><i class="fa fa-chevron-left"></i> Terminal Wizard part 3</a></div><div class="post-nav-prev post-nav-item"><a href="/2015/11/8/reduce-all-the-things-part2/" rel="prev" title="Reduce All the Things! (part 2)">Reduce All the Things! (part 2) <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2016</span> <span class="with-love"><i class="icon-next-heart fa fa-beer"></i></span> <span class="author" itemprop="copyrightHolder">jyoko</span></div><div class="powered-by">Powered by <a class="theme-link" href="http://hexo.io">Hexo</a></div><div class="theme-info">Theme - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div></div></footer><div class="back-to-top"></div></div><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script><script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script><script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.2" id="bootstrap.scrollspy.custom"></script><script type="text/javascript" id="sidebar.toc.highlight">$(document).ready(function(){function o(){$(s+" "+r).removeClass(r.substring(1))}function t(){i(),n()}function i(){var o=$(".sidebar").height()-a.position().top-$(".post-toc-indicator-bottom").height();return a.css("height",o),o}function n(){c(".post-toc-indicator-top",a.scrollTop()>0?"show":"hide"),c(".post-toc-indicator-bottom",a.scrollTop()>=a.find("ol").height()-a.height()?"hide":"show")}function e(o){o.on("mousewheel DOMMouseScroll",function(o){var t=o.originalEvent,i=t.wheelDelta||-t.detail;this.scrollTop+=30*(0>i?1:-1),o.preventDefault(),n()})}function c(o,t){var i=$(o),n="show"===t?1:0;i.velocity?i.velocity("stop").velocity({opacity:n},{duration:100}):i.stop().animate({opacity:n},100)}var s=".post-toc",a=$(s),r=".active-current";a.on("activate.bs.scrollspy",function(){var t=$(s+" .active").last();o(),t.addClass("active-current"),a[0].scrollTop=t.position().top}).on("clear.bs.scrollspy",function(){o()}),$(document).on("sidebar.motion.complete",function(){t()}),$("body").scrollspy({target:s}),$(window).on("resize",function(){$(".sidebar").hasClass("sidebar-active")&&t()}),e(a)});</script><script type="text/javascript" id="sidebar.nav">$(document).ready(function(){var t=$("html"),i=200,a=$.isFunction(t.velocity);$(".sidebar-nav li").on("click",function(){var t=$(this),o="sidebar-nav-active",e="sidebar-panel-active";if(!t.hasClass(o)){var s=$("."+e),n=$("."+t.data("target"));a?s.velocity("transition.slideUpOut",i,function(){n.velocity("stop").velocity("transition.slideDownIn",i).addClass(e)}):s.animate({opacity:0},i,function(){s.hide(),n.stop().css({opacity:0,display:"block"}).animate({opacity:1},i,function(){s.removeClass(e),n.addClass(e)})}),t.siblings().removeClass(o),t.addClass(o)}}),$(".post-toc a").on("click",function(i){i.preventDefault();var o=escapeSelector(this.getAttribute("href")),e=$(o).offset().top;a?t.velocity("stop").velocity("scroll",{offset:e+"px",mobileHA:!1}):$("html, body").stop().animate({scrollTop:e},500)}),motionMiddleWares.sidebar=function(){var t=$(".post-toc-content");"post"===CONFIG.sidebar&&t.length>0&&t.html().trim().length>0&&displaySidebar()}});</script><script type="text/javascript" src="/js/bootstrap.js"></script></body></html>